import React, { useState } from 'react'
import { withRouter, NavLink as Link } from 'react-router-dom'
import cx from 'classnames'
import { compose } from 'redux'
import { connect } from 'react-redux'
import { Button } from '@santiment-network/ui'
import MobileNavbarAction from './MobileNavbarAction'
import styles from './MobileNavbar.module.scss'
import * as actions from './../../actions/types'

const NAVBAR_LINKS = [
  {
    link: '/trends',
    label: 'Trends',
    linkTo: '/labs/trends',
    iconType: 'fire'
  },
  {
    link: '/assets',
    label: 'Assets',
    linkTo: '/assets/all',
    iconType: 'assets'
  },
  {
    link: '/insights',
    label: 'Insights',
    iconType: 'bulb',
    linkTo: '/insights'
  }
]

const MENU_LINKS = [
  { link: '/account', label: 'Account settings' },
  { link: '/support', label: 'Support' }
]

const MobileNavbar = ({ history, isLogined, activeLink, logout }) => {
  const [isOpened, setOpened] = useState(false)

  const toggleMenu = () => setOpened(!isOpened)

  const handleNavigation = linkTo => {
    isOpened && toggleMenu()
    history.push(linkTo)
  }

  return (
    <div className={cx({ [styles.overlay]: isOpened })}>
      <div className={styles.wrapper}>
        {NAVBAR_LINKS.map(({ link, label, linkTo, iconType }) => {
          return (
            <MobileNavbarAction
              key={label}
              isActive={!isOpened && activeLink.includes(link)}
              linkTo={linkTo}
              iconType={iconType}
              onClick={handleNavigation}
              label={label}
            />
          )
        })}
        <MobileNavbarAction
          onClick={toggleMenu}
          iconType={isOpened ? 'close' : 'hamburger'}
          isActive={isOpened}
          label='Menu'
        />
      </div>
      {isOpened && (
        <div className={styles.overlayContent}>
          <div>
            <div className={styles.logo}>
              <SantimentLogo />
            </div>
            <div onClick={toggleMenu} className={styles.navigationList}>
              {MENU_LINKS.map(({ link, label }) => (
                <Link
                  key={link}
                  to={link}
                  className={styles.navigationList__link}
                >
                  {label}
                </Link>
              ))}
            </div>
          </div>
          <Button
            className={styles.loginBtn}
            variant='fill'
            accent='positive'
            onClick={() => {
              if (isLogined) {
                toggleMenu()
                logout()
              } else {
                handleNavigation('/login')
              }
            }}
          >
            {isLogined ? 'Logout' : 'Login'}
          </Button>
        </div>
      )}
    </div>
  )
}

const SantimentLogo = () => (
  <svg
    width='132'
    height='24'
    viewBox='0 0 132 24'
    fill='none'
    xmlns='http://www.w3.org/2000/svg'
  >
    <path
      d='M10.1948 20.8808C10.6372 21.1458 11.1626 21.373 11.7709 21.561C12.3792 21.749 13.0036 21.843 13.6455 21.843C14.3755 21.843 14.9944 21.6596 15.5036 21.2923C16.0124 20.9255 16.2668 20.3301 16.2668 19.507C16.2668 18.8176 16.1119 18.2499 15.8023 17.8056C15.4926 17.3605 15.0999 16.96 14.6244 16.6042C14.1483 16.2485 13.634 15.9213 13.0815 15.6236C12.5285 15.3259 12.0142 14.9683 11.5386 14.5494C11.0626 14.1305 10.6704 13.6351 10.3607 13.0613C10.0506 12.488 9.89619 11.7604 9.89619 10.8788C9.89619 9.46773 10.2778 8.40458 11.0409 7.68844C11.804 6.97184 12.8824 6.61377 14.276 6.61377C15.1829 6.61377 15.9682 6.69672 16.6318 6.86262C17.2954 7.02852 17.8705 7.25571 18.3571 7.54281L17.7267 9.53363C17.306 9.31289 16.8193 9.1304 16.2668 8.98616C15.7133 8.84237 15.1497 8.77048 14.5746 8.77048C13.7783 8.77048 13.1976 8.93638 12.8326 9.26819C12.4677 9.59999 12.2852 10.1198 12.2852 10.8277C12.2852 11.3811 12.4395 11.8512 12.7497 12.2378C13.0594 12.6254 13.4515 12.9793 13.9276 13.3C14.4032 13.6208 14.917 13.9466 15.4705 14.2789C16.023 14.6107 16.5373 15.0033 17.0133 15.4568C17.4889 15.9102 17.8811 16.4522 18.1912 17.0826C18.5009 17.713 18.6558 18.5038 18.6558 19.4545C18.6558 20.0743 18.5562 20.6605 18.3571 21.2131C18.1581 21.7661 17.8539 22.2472 17.4447 22.6564C17.035 23.0661 16.5267 23.3924 15.9184 23.6352C15.3101 23.8781 14.5963 24.0002 13.7783 24.0002C12.8045 24.0002 11.964 23.9057 11.2566 23.7182C10.5483 23.5306 9.95103 23.2818 9.46484 22.9716L10.1948 20.8808Z'
      fill='#181B2B'
    />
    <path
      d='M21.5038 8.00499C22.1453 7.60683 22.9246 7.29714 23.843 7.07594C24.7605 6.8552 25.7287 6.74414 26.7463 6.74414C27.6753 6.74414 28.4219 6.88285 28.9859 7.15889C29.55 7.43585 29.9924 7.81144 30.3131 8.28702C30.6334 8.76306 30.844 9.30455 30.9436 9.91285C31.0431 10.5216 31.0929 11.1571 31.0929 11.8207C31.0929 13.1479 31.0643 14.4419 31.0072 15.7028C30.95 16.9636 30.9219 18.1581 30.9219 19.2863C30.9219 20.1268 30.95 20.907 31.0072 21.625C31.0643 22.3444 31.1703 23.0246 31.3251 23.666H29.4546L28.8744 21.7084H28.7426C28.4131 22.2835 27.9302 22.7812 27.2937 23.2015C26.6569 23.6213 25.8006 23.8315 24.7246 23.8315C23.5388 23.8315 22.5674 23.4172 21.8098 22.5877C21.0522 21.7577 20.6738 20.6135 20.6738 19.1535C20.6738 18.2028 20.8324 17.406 21.1508 16.7641C21.4692 16.1226 21.9185 15.6028 22.5001 15.2046C23.0812 14.8065 23.7725 14.5244 24.5734 14.3585C25.3739 14.1926 26.2684 14.1097 27.2555 14.1097C27.4748 14.1097 27.6942 14.1097 27.9131 14.1097C28.1325 14.1097 28.3633 14.1207 28.6048 14.1429C28.6703 13.4576 28.7034 12.8484 28.7034 12.3179C28.7034 11.0571 28.5168 10.1723 28.1444 9.66308C27.7716 9.15431 27.0919 8.89993 26.1062 8.89993C25.4923 8.89993 24.8241 8.9944 24.1006 9.18196C23.3766 9.37044 22.7743 9.60824 22.2923 9.89534L21.5038 8.00499ZM28.6375 16.0346C28.4186 16.0129 28.2002 15.9963 27.9818 15.9853C27.7633 15.9742 27.5449 15.9687 27.3265 15.9687C26.8016 15.9687 26.2882 16.0134 25.785 16.1014C25.2822 16.1899 24.8343 16.3447 24.4412 16.5659C24.0476 16.7871 23.7361 17.0858 23.507 17.4618C23.2776 17.8378 23.1628 18.3134 23.1628 18.8885C23.1628 19.7734 23.3757 20.4591 23.802 20.9457C24.2283 21.4328 24.7799 21.6757 25.4573 21.6757C26.3748 21.6757 27.085 21.4549 27.5882 21.0121C28.091 20.5701 28.4408 20.083 28.6375 19.5522V16.0346Z'
      fill='#181B2B'
    />
    <path
      d='M43.4492 23.5991V13.4791C43.4492 11.8201 43.2552 10.6206 42.8686 9.87909C42.4815 9.13852 41.7902 8.76755 40.7948 8.76755C39.91 8.76755 39.18 9.03299 38.6049 9.56388C38.0293 10.0948 37.6095 10.7473 37.3441 11.5215V23.5991H34.9551V7.009H36.6804L37.1118 8.76755H37.2113C37.6312 8.17031 38.2007 7.66201 38.9201 7.24126C39.6386 6.82144 40.4962 6.61084 41.4916 6.61084C42.1994 6.61084 42.8239 6.71038 43.3663 6.90946C43.9082 7.10854 44.3617 7.44588 44.7266 7.92146C45.0916 8.3975 45.3681 9.033 45.5562 9.82932C45.7437 10.6256 45.8382 11.6326 45.8382 12.8487V23.5991H43.4492Z'
      fill='#181B2B'
    />
    <path
      d='M47.8574 7.00868H49.8814V3.72384L52.2704 2.96069V7.00868H55.8539V9.16539H52.2704V19.0535C52.2704 20.0268 52.3865 20.7291 52.6188 21.16C52.851 21.5918 53.2326 21.807 53.7635 21.807C54.2059 21.807 54.5875 21.7573 54.9082 21.6577C55.2285 21.5582 55.5769 21.4315 55.9534 21.2762L56.4179 23.1674C55.9308 23.4108 55.3944 23.6038 54.8087 23.7481C54.2225 23.8919 53.6087 23.9638 52.9672 23.9638C51.8612 23.9638 51.0704 23.6043 50.5948 22.8854C50.1187 22.1665 49.8814 20.9997 49.8814 19.3849V9.16539H47.8574V7.00868Z'
      fill='#181B2B'
    />
    <path
      d='M58.4434 1.971C58.4434 1.38666 58.6079 0.912455 58.936 0.547473C59.2646 0.182491 59.6959 0 60.2319 0C60.7669 0 61.2111 0.1765 61.5641 0.529039C61.9167 0.88204 62.0932 1.36315 62.0932 1.971C62.0932 2.55488 61.9167 3.0111 61.5641 3.33968C61.2111 3.66825 60.7669 3.83231 60.2319 3.83231C59.6964 3.83231 59.2646 3.66226 58.936 3.32125C58.6074 2.98115 58.4434 2.53091 58.4434 1.971ZM59.0406 7.00932H61.4296V23.5994H59.0406V7.00932Z'
      fill='#181B2B'
    />
    <path
      d='M73.5942 23.5991V13.7446C73.5942 12.8602 73.5661 12.1022 73.5113 11.4717C73.4555 10.8413 73.3394 10.327 73.1629 9.92886C72.9855 9.5307 72.7422 9.23761 72.4329 9.04958C72.1228 8.86156 71.7136 8.76755 71.2053 8.76755C70.4532 8.76755 69.8168 9.0611 69.2974 9.64683C68.7776 10.233 68.4181 10.9026 68.2191 11.6542V23.5991H65.8301V7.009H67.5223L67.9536 8.76755H68.0532C68.5177 8.12607 69.0707 7.60624 69.7122 7.20808C70.3536 6.80992 71.1721 6.61084 72.1675 6.61084C73.0076 6.61084 73.6989 6.79333 74.2413 7.15831C74.7832 7.52329 75.2086 8.17031 75.5182 9.09936C75.9164 8.32515 76.486 7.71684 77.227 7.27444C77.9676 6.83204 78.781 6.61084 79.6658 6.61084C80.3957 6.61084 81.0202 6.70531 81.5404 6.89287C82.0598 7.08089 82.4801 7.41269 82.8013 7.88828C83.1216 8.36432 83.3594 8.99428 83.5147 9.77955C83.669 10.5648 83.7469 11.5547 83.7469 12.7492V23.5991H81.3575V13.0483C81.3575 11.6105 81.2192 10.5376 80.9432 9.82978C80.6662 9.12194 80.0307 8.76801 79.0349 8.76801C78.1943 8.76801 77.5256 9.02839 77.0279 9.54775C76.5302 10.0676 76.1818 10.7703 75.9823 11.6547V23.5996H73.5942V23.5991Z'
      fill='#181B2B'
    />
    <path
      d='M97.3598 22.4712C96.8294 22.9584 96.1543 23.3339 95.3358 23.5994C94.5174 23.8648 93.6547 23.9975 92.7478 23.9975C91.7077 23.9975 90.8067 23.7929 90.0436 23.3837C89.2809 22.9745 88.6505 22.3883 88.1523 21.6252C87.6546 20.8625 87.2896 19.9496 87.0574 18.8882C86.8251 17.8269 86.709 16.632 86.709 15.3048C86.709 12.4734 87.2283 10.3167 88.2685 8.83464C89.3081 7.35306 90.7786 6.61157 92.6814 6.61157C93.3003 6.61157 93.9142 6.68899 94.5229 6.84383C95.1308 6.99867 95.6782 7.30835 96.1649 7.77288C96.6515 8.2374 97.0442 8.89041 97.3432 9.73051C97.6414 10.5715 97.7912 11.6665 97.7912 13.0153C97.7912 13.3914 97.7746 13.7951 97.7414 14.2264C97.7087 14.6582 97.6695 15.1057 97.6253 15.5702H89.1975C89.1975 16.5214 89.2749 17.3845 89.4298 18.1583C89.5846 18.9329 89.8279 19.5906 90.1597 20.1325C90.492 20.6749 90.9173 21.0947 91.4372 21.3929C91.9565 21.6915 92.6035 21.8413 93.3782 21.8413C93.9754 21.8413 94.5672 21.7307 95.1533 21.509C95.7391 21.2883 96.1875 21.0228 96.4971 20.7127L97.3598 22.4712ZM95.5022 13.579C95.5464 11.9199 95.3137 10.7038 94.8049 9.92913C94.2962 9.15493 93.5994 8.76782 92.7146 8.76782C91.6971 8.76782 90.8897 9.15493 90.2924 9.92913C89.6952 10.7038 89.3413 11.9199 89.2307 13.579H95.5022Z'
      fill='#181B2B'
    />
    <path
      d='M109.631 23.5991V13.4791C109.631 11.8201 109.437 10.6206 109.05 9.87909C108.663 9.13852 107.972 8.76755 106.976 8.76755C106.091 8.76755 105.361 9.03299 104.787 9.56388C104.211 10.0948 103.791 10.7473 103.526 11.5215V23.5991H101.137V7.009H102.862L103.293 8.76755H103.393C103.813 8.17031 104.382 7.66201 105.102 7.24126C105.821 6.82144 106.678 6.61084 107.673 6.61084C108.381 6.61084 109.006 6.71038 109.548 6.90946C110.09 7.10854 110.543 7.44588 110.908 7.92146C111.273 8.3975 111.55 9.033 111.738 9.82932C111.925 10.6256 112.019 11.6326 112.019 12.8487V23.5991H109.631Z'
      fill='#181B2B'
    />
    <path
      d='M114.049 7.00868H116.073V3.72384L118.462 2.96069V7.00868H122.045V9.16539H118.462V19.0535C118.462 20.0268 118.578 20.7291 118.811 21.16C119.043 21.5918 119.424 21.807 119.955 21.807C120.397 21.807 120.779 21.7573 121.1 21.6577C121.42 21.5582 121.768 21.4315 122.145 21.2762L122.61 23.1674C122.123 23.4108 121.586 23.6038 121.001 23.7481C120.414 23.8919 119.801 23.9638 119.159 23.9638C118.053 23.9638 117.262 23.6043 116.787 22.8854C116.311 22.1665 116.073 20.9997 116.073 19.3849V9.16539H114.049V7.00868H114.049Z'
      fill='#181B2B'
    />
    <path
      d='M0 14.7271C0 14.1428 0.164518 13.6686 0.492634 13.3036C0.82121 12.9386 1.25255 12.7561 1.7885 12.7561C2.32354 12.7561 2.76778 12.9326 3.12078 13.2851C3.47332 13.6381 3.64982 14.1193 3.64982 14.7271C3.64982 15.311 3.47332 15.7672 3.12078 16.0958C2.76778 16.4244 2.32354 16.5884 1.7885 16.5884C1.25301 16.5884 0.82121 16.4184 0.492634 16.0774C0.164518 15.7373 0 15.287 0 14.7271Z'
      fill='#181B2B'
    />
    <path
      d='M127.418 14.7271C127.418 14.1428 127.582 13.6686 127.911 13.3036C128.239 12.9386 128.671 12.7561 129.206 12.7561C129.742 12.7561 130.186 12.9326 130.539 13.2851C130.891 13.6381 131.068 14.1193 131.068 14.7271C131.068 15.311 130.891 15.7672 130.539 16.0958C130.186 16.4244 129.742 16.5884 129.206 16.5884C128.671 16.5884 128.239 16.4184 127.911 16.0774C127.582 15.7373 127.418 15.287 127.418 14.7271Z'
      fill='#181B2B'
    />
  </svg>
)

const mapStateToProps = ({ user = {} }) => {
  return {
    isLogined: !!user.token
  }
}

const mapDispatchToProps = dispatch => {
  return {
    logout: () => {
      dispatch({
        type: actions.USER_LOGOUT_SUCCESS
      })
    }
  }
}

const enhance = compose(
  withRouter,
  connect(
    mapStateToProps,
    mapDispatchToProps
  )
)

export default enhance(MobileNavbar)
