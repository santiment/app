import React, { useState } from 'react'
import { Link, Redirect } from 'react-router-dom'
import cx from 'classnames'
import { connect } from 'react-redux'
import { compose } from 'redux'
import Button from '@santiment-network/ui/Button'
import { Checkbox } from '@santiment-network/ui/Checkboxes'
import Panel from '@santiment-network/ui/Panel'
import * as actions from './../../actions/types'
import styles from './GDPRPage.module.scss'
import MobileWrapper from '../Login/Mobile/MobileWrapper'
import { useUser } from '../../stores/user'

const GdprDescription = ({ toggleGDPR, isGDPR, togglePrivacyPolicy }) => {
  return (
    <>
      <h3 className={styles.title}>We value your privacy</h3>
      <p className={styles.description}>
        Please review and accept our Privacy Policy to continue using Sanbase
      </p>
      <div className={styles.check}>
        <Checkbox
          isActive={isGDPR}
          onClick={toggleGDPR}
          className={styles.checkbox}
        />
        <div className={styles.checkDescription}>
          <label className={styles.accept}>
            &nbsp;I have read and accept the &nbsp;
          </label>
          <Link to='/privacy-policy' className={styles.link}>
            Santiment Privacy Policy
          </Link>
        </div>
      </div>
      <Button
        className={styles.toggleBtn}
        disabled={!isGDPR}
        variant='fill'
        accent='positive'
        onClick={togglePrivacyPolicy}
      >
        Continue
      </Button>
    </>
  )
}

const GDPRPage = ({ togglePrivacyPolicy, isDesktop }) => {
  const { user } = useUser()
  const [isGDPR, setGDPR] = useState(false)
  const toggleGDPR = () => setGDPR(!isGDPR)

  if (user && user.privacyPolicyAccepted) {
    return <Redirect to='/' />
  }

  const child = (
    <GdprDescription
      toggleGDPR={toggleGDPR}
      isGDPR={isGDPR}
      togglePrivacyPolicy={togglePrivacyPolicy}
    />
  )

  return isDesktop ? (
    <div className={cx('page', styles.wrapper)}>
      <Panel padding className={styles.container}>
        {child}
      </Panel>
    </div>
  ) : (
    <div className={styles.container}>
      <svg
        className={styles.santimentLogo}
        width='130'
        height='24'
        viewBox='0 0 130 24'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'
      >
        <path
          d='M57.1532 1.80529C57.1532 1.27032 57.3104 0.836008 57.6259 0.501418C57.9414 0.166829 58.3566 0 58.8704 0C59.3841 0 59.81 0.162169 60.149 0.484642C60.4869 0.808048 60.6569 1.24795 60.6569 1.80529C60.6569 2.34026 60.4869 2.7578 60.149 3.05884C59.81 3.35988 59.3841 3.50993 58.8704 3.50993C58.3566 3.50993 57.9424 3.35428 57.6269 3.04206C57.3114 2.72984 57.1532 2.31789 57.1532 1.80529Z'
          fill='var(--mirage)'
        />
        <path
          d='M60.1314 6.88565V23.5993H57.6093V6.88565H60.1314Z'
          fill='var(--mirage)'
        />
        <path
          d='M47.9405 6.88563H45.8033V9.05813H47.9405V19.354C47.9405 20.9813 48.1916 22.1565 48.6936 22.8807C49.1957 23.6049 50.0299 23.9674 51.1981 23.9674C51.875 23.9674 52.5226 23.8947 53.1419 23.7502C53.7612 23.6049 54.3277 23.4101 54.8415 23.1649L54.3512 21.2599C53.9536 21.4156 53.5854 21.5433 53.2474 21.6439C52.9085 21.7436 52.506 21.794 52.0391 21.794C51.4794 21.794 51.076 21.5768 50.8308 21.1425C50.5857 20.7082 50.4626 20.0008 50.4626 19.0203V9.05906H54.2457V6.88656H50.4626V2.80811L47.9405 3.57701V6.88563Z'
          fill='var(--mirage)'
        />
        <path
          d='M6.04193 20.8582C6.50884 21.1257 7.06365 21.354 7.70638 21.5432C8.34812 21.7324 9.00843 21.8275 9.68534 21.8275C10.456 21.8275 11.1095 21.643 11.6467 21.273C12.184 20.9029 12.4526 20.3037 12.4526 19.4742C12.4526 18.7798 12.2885 18.2085 11.9622 17.7602C11.635 17.3119 11.2209 16.9084 10.7188 16.5495C10.2167 16.1917 9.67362 15.8617 9.0895 15.5616C8.50539 15.2615 7.96229 14.9018 7.46022 14.4796C6.95816 14.0574 6.54302 13.5578 6.21678 12.9809C5.88955 12.4031 5.72643 11.6705 5.72643 10.7823C5.72643 9.36098 6.12887 8.29011 6.93471 7.5678C7.74056 6.8455 8.8795 6.48481 10.3505 6.48481C11.3078 6.48481 12.1371 6.56869 12.8374 6.73552C13.5378 6.90235 14.1453 7.13163 14.6591 7.42055L13.9939 9.42622C13.5505 9.20347 13.0357 9.01987 12.4526 8.87448C11.8685 8.73002 11.2726 8.65732 10.666 8.65732C9.82502 8.65732 9.21258 8.82415 8.82675 9.15874C8.44092 9.49333 8.24849 10.0171 8.24849 10.7301C8.24849 11.2874 8.41161 11.7609 8.73884 12.1505C9.06606 12.541 9.48022 12.897 9.98229 13.2204C10.4844 13.5438 11.0274 13.8719 11.6116 14.2065C12.1947 14.5411 12.7378 14.9362 13.2408 15.3929C13.7429 15.8496 14.1571 16.3958 14.4843 17.0305C14.8115 17.6652 14.9746 18.463 14.9746 19.4201C14.9746 20.0446 14.8691 20.6345 14.6591 21.1919C14.4491 21.7492 14.1278 22.2338 13.696 22.6458C13.2633 23.0587 12.7271 23.3867 12.0843 23.6319C11.4416 23.877 10.6885 24 9.82502 24C8.79745 24 7.90955 23.9049 7.16231 23.7157C6.41506 23.5265 5.78406 23.2758 5.27027 22.9636L6.04193 20.8582Z'
          fill='var(--mirage)'
        />
        <path
          d='M0 15.6763C0 15.1102 0.157746 14.6855 0.474217 14.402C0.790688 14.1185 1.21787 13.9772 1.75676 13.9772C2.29564 13.9772 2.72283 14.1194 3.0393 14.402C3.35577 14.6855 3.51351 15.1102 3.51351 15.6763C3.51351 16.2635 3.35577 16.6984 3.0393 16.981C2.72283 17.2637 2.29564 17.4058 1.75676 17.4058C1.21787 17.4058 0.790688 17.2637 0.474217 16.981C0.157746 16.6984 0 16.2635 0 15.6763Z'
          fill='var(--mirage)'
        />
        <path
          fillRule='evenodd'
          clipRule='evenodd'
          d='M20.459 6.95276C19.489 7.17551 18.6656 7.48773 17.9887 7.88849L18.8229 9.79071C19.3327 9.50179 19.9686 9.26133 20.7325 9.07213C21.4963 8.88294 22.2015 8.78787 22.8501 8.78787C23.8904 8.78787 24.6083 9.04417 25.002 9.55678C25.3946 10.0694 25.592 10.9604 25.592 12.2307C25.592 12.7657 25.5578 13.3789 25.4884 14.0695C25.2325 14.0472 24.9893 14.036 24.7578 14.036H24.0633C23.0211 14.036 22.0765 14.1199 21.2316 14.2867C20.3857 14.4545 19.6561 14.7387 19.0426 15.1395C18.4282 15.5412 17.9535 16.065 17.6175 16.7108C17.2805 17.3567 17.1135 18.1592 17.1135 19.1173C17.1135 20.588 17.513 21.7409 18.313 22.5769C19.113 23.4129 20.1386 23.8304 21.3908 23.8304C22.5268 23.8304 23.4313 23.6189 24.1033 23.1957C24.7754 22.7726 25.2853 22.2712 25.633 21.6915H25.7717L26.3841 23.6636H28.3592C28.1951 23.0168 28.0837 22.3318 28.0232 21.6076C27.9626 20.8844 27.9333 20.0987 27.9333 19.2515C27.9333 18.1154 27.9626 16.9122 28.0232 15.6418C28.0828 14.3715 28.113 13.0686 28.113 11.7311C28.113 11.0629 28.0613 10.4226 27.9558 9.80935C27.8513 9.19702 27.6285 8.65087 27.2906 8.17182C26.9516 7.6937 26.4847 7.31437 25.8889 7.0357C25.2931 6.75797 24.5048 6.61817 23.5241 6.61817C22.4496 6.61817 21.4279 6.73001 20.459 6.95276ZM24.8281 15.928C25.0596 15.9391 25.2892 15.9559 25.5207 15.9783H25.5197V19.5208C25.3116 20.0558 24.9434 20.546 24.412 20.9915C23.8816 21.437 23.1314 21.6598 22.1625 21.6598C21.4475 21.6598 20.8653 21.4147 20.415 20.9244C19.9647 20.4342 19.7401 19.7436 19.7401 18.8517C19.7401 18.2729 19.8612 17.7938 20.1034 17.4145C20.3457 17.0361 20.6748 16.7351 21.09 16.5123C21.5051 16.2896 21.9779 16.1339 22.5092 16.0445C23.0406 15.9559 23.5827 15.9112 24.1366 15.9112C24.3671 15.9112 24.5976 15.9168 24.8281 15.928Z'
          fill='var(--mirage)'
        />
        <path
          d='M41.1436 23.5992V13.404C41.1436 11.7329 40.9385 10.5241 40.5302 9.77759C40.1209 9.03105 39.3913 8.65825 38.3402 8.65825C37.4055 8.65825 36.6348 8.92573 36.0282 9.4607C35.4207 9.99567 34.9772 10.6527 34.6969 11.4328V23.6001H32.1748V6.88558H33.9965L34.4517 8.65732H34.5572C35.0007 8.05524 35.6023 7.54357 36.3613 7.11951C37.1203 6.69638 38.0257 6.48481 39.0767 6.48481C39.824 6.48481 40.4833 6.58547 41.0557 6.78585C41.6281 6.98623 42.1067 7.32641 42.4925 7.80546C42.8774 8.28451 43.1694 8.9248 43.3687 9.72726C43.567 10.5297 43.6666 11.5437 43.6666 12.7693V23.5992H41.1436Z'
          fill='var(--mirage)'
        />
        <path
          d='M72.9884 13.6716V23.5984H75.5104V11.5653C75.7204 10.6743 76.0887 9.96688 76.6142 9.44309C77.1397 8.9193 77.8459 8.65741 78.7338 8.65741C79.7848 8.65741 80.4559 9.01437 80.748 9.72735C81.039 10.4413 81.1856 11.5215 81.1856 12.9698V23.5984H83.7076V12.6678C83.7076 11.4646 83.6256 10.4674 83.4624 9.67609C83.2993 8.88575 83.0473 8.25012 82.7093 7.77107C82.3704 7.29202 81.9269 6.95744 81.378 6.76824C80.829 6.57904 80.1697 6.48398 79.399 6.48398C78.4642 6.48398 77.6066 6.70673 76.8242 7.15222C76.0418 7.59865 75.4401 8.21098 75.0201 8.99107C74.6929 8.05534 74.2435 7.40293 73.6711 7.03572C73.0978 6.66758 72.3681 6.48398 71.4812 6.48398C70.4302 6.48398 69.5657 6.68529 68.8888 7.08605C68.2119 7.48774 67.6278 8.01153 67.1374 8.65741H67.0319L66.5768 6.88567H64.7902V23.5984H67.3123V11.5653C67.5233 10.8075 67.9023 10.1337 68.4512 9.54281C68.9992 8.95286 69.6712 8.65741 70.4653 8.65741C71.0026 8.65741 71.4343 8.75248 71.7615 8.94167C72.0888 9.13087 72.3447 9.42631 72.5322 9.82708C72.7188 10.2288 72.8419 10.747 72.9005 11.3817C72.9591 12.0173 72.9884 12.7806 72.9884 13.6716Z'
          fill='var(--mirage)'
        />
        <path
          fillRule='evenodd'
          clipRule='evenodd'
          d='M98.0707 22.4623C97.51 22.9525 96.7969 23.3318 95.9335 23.5984C95.069 23.8659 94.1586 23.9991 93.2014 23.9991C92.1035 23.9991 91.1521 23.7932 90.3462 23.3812C89.5404 22.9693 88.8752 22.3784 88.3497 21.6095C87.8242 20.8406 87.4393 19.9216 87.1942 18.8517C86.949 17.7817 86.8259 16.5785 86.8259 15.242C86.8259 12.3901 87.3749 10.2167 88.4728 8.72358C89.5707 7.23051 91.1228 6.48398 93.132 6.48398C93.7855 6.48398 94.4341 6.56227 95.0768 6.71791C95.7186 6.87449 96.2968 7.18578 96.8106 7.65364C97.3244 8.12151 97.7385 8.7795 98.0541 9.62576C98.3696 10.473 98.5268 11.5764 98.5268 12.9353C98.5268 13.3146 98.5092 13.721 98.4741 14.1553C98.4389 14.5896 98.3979 15.0407 98.352 15.5095H89.4535C89.4535 16.4676 89.5345 17.3372 89.6986 18.1173C89.8618 18.8973 90.1187 19.56 90.4693 20.1062C90.82 20.6523 91.2693 21.0754 91.8183 21.3765C92.3672 21.6775 93.05 21.8276 93.8676 21.8276C94.4986 21.8276 95.1227 21.7167 95.742 21.493C96.3603 21.2702 96.8331 21.0027 97.1613 20.6905L98.0707 22.4623ZM96.1093 13.5048C96.1562 11.8337 95.911 10.6081 95.3738 9.82801C94.8365 9.04792 94.1 8.65834 93.1672 8.65834C92.0927 8.65834 91.24 9.04885 90.61 9.82801C89.979 10.6081 89.6058 11.8337 89.4886 13.5048H96.1093Z'
          fill='var(--mirage)'
        />
        <path
          d='M111.033 13.404V23.5992H113.554V12.7693C113.554 11.5437 113.454 10.5297 113.256 9.72726C113.057 8.9248 112.766 8.28451 112.38 7.80546C111.995 7.32641 111.516 6.98623 110.944 6.78585C110.371 6.58547 109.712 6.48481 108.965 6.48481C107.915 6.48481 107.009 6.69638 106.25 7.11951C105.491 7.54357 104.89 8.05524 104.446 8.65732H104.341L103.886 6.88558H102.064V23.6001H104.586V11.4328C104.866 10.6527 105.31 9.99567 105.917 9.4607C106.524 8.92573 107.295 8.65825 108.229 8.65825C109.28 8.65825 110.01 9.03105 110.419 9.77759C110.828 10.5241 111.033 11.7329 111.033 13.404Z'
          fill='var(--mirage)'
        />
        <path
          d='M115.692 6.88563H117.829V3.57701L120.351 2.80811V6.88656H124.134V9.05906H120.351V19.0203C120.351 20.0008 120.473 20.7082 120.719 21.1425C120.964 21.5768 121.367 21.794 121.927 21.794C122.394 21.794 122.797 21.7436 123.136 21.6439C123.474 21.5433 123.842 21.4156 124.239 21.2599L124.73 23.1649C124.216 23.4101 123.649 23.6049 123.031 23.7502C122.412 23.8947 121.764 23.9674 121.086 23.9674C119.918 23.9674 119.084 23.6049 118.582 22.8807C118.08 22.1565 117.829 20.9813 117.829 19.354V9.05813H115.692V6.88563Z'
          fill='var(--mirage)'
        />
        <path
          d='M126.961 14.1391C126.644 14.4225 126.486 14.8473 126.486 15.4133C126.486 16.0006 126.644 16.4355 126.961 16.7181C127.277 17.0007 127.704 17.1429 128.243 17.1429C128.782 17.1429 129.209 17.0007 129.526 16.7181C129.842 16.4355 130 16.0006 130 15.4133C130 14.8473 129.842 14.4225 129.526 14.1391C129.209 13.8564 128.782 13.7143 128.243 13.7143C127.704 13.7143 127.277 13.8556 126.961 14.1391Z'
          fill='var(--mirage)'
        />
      </svg>
      <MobileWrapper className={styles.mobileWrapper}>{child}</MobileWrapper>
    </div>
  )
}

const mapDispatchToProps = dispatch => {
  return {
    togglePrivacyPolicy: () => {
      dispatch({ type: actions.USER_TOGGLE_PRIVACY_POLICY })
    }
  }
}

const enhance = compose(
  connect(
    null,
    mapDispatchToProps
  )
)

export default enhance(GDPRPage)
